<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Three Treasures of Justification - Prayer Presentation">
    <title>Three Treasures of Justification - Prayer Presentation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.1.0/dist/reset.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.1.0/dist/reveal.css">
    <link rel="stylesheet" href="../css/theme-prayer.css">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <style>
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--accent, #ffd166);
            color: #14213d;
            padding: 8px 16px;
            text-decoration: none;
            z-index: 9999;
            font-weight: 600;
            border-radius: 0 0 8px 0;
        }
        .skip-link:focus { top: 0; }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to content</a>
    <a href="../index.html" class="home-btn" aria-label="Return to presentations list">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
        </svg>
        <span>Home</span>
    </a>

    <div class="reveal" id="main-content">
        <div class="slides">
            <section data-auto-animate data-background-gradient="radial-gradient(ellipse at center, #1b263b 0%, #0d1b2a 100%)">
<h1>Three Treasures of Justification</h1>
      <h2>Living in the Fullness of Grace</h2>
      <div class="scripture">
        <p class="scripture-text">"Therefore, having been justified by faith, we have peace with God through our Lord Jesus Christ, through whom also we have access by faith into this grace in which we stand, and rejoice in hope of the glory of God."</p>
        <p class="scripture-ref">Romans 5:1-5</p>
      </div>
      <div class="subtitle" style="margin-top: 2rem;">Bishop Darlingston Johnson</div>
      <div class="subtitle">September 29, 2025</div>
            </section>

            <section>
<h2>Salvation Explained Series</h2>
      <h3 style="color: #ffd166;">Part 2: From Guilt to Glory</h3>
      <div class="content-list" style="max-width: 900px;">
        <ul style="list-style: none; padding: 0;">
          <li style="margin: 1.5rem 0; padding: 1.5rem; background: rgba(255,255,255,0.1); border-radius: 12px;">
            <a href="Gospel_of_Grace_Presentation.html" style="color: #fff; text-decoration: none; display: flex; align-items: center;">
              <span style="background: rgba(255,255,255,0.3); color: #fff; padding: 0.5rem 1rem; border-radius: 50%; font-weight: bold; margin-right: 1rem;">1</span>
              <span style="font-size: 1.6rem;">Part 1: Peace with God →</span>
            </a>
          </li>
          <li style="margin: 1.5rem 0; padding: 1.5rem; background: rgba(255,255,255,0.15); border-radius: 12px; border-left: 5px solid #ffd166;">
            <span style="background: #ffd166; color: #14213d; padding: 0.5rem 1rem; border-radius: 50%; font-weight: bold; margin-right: 1rem;">2</span>
            <strong style="font-size: 1.8rem;">Part 2: Standing in Grace (Current)</strong>
          </li>
          <li style="margin: 1.5rem 0; padding: 1.5rem; background: rgba(255,255,255,0.1); border-radius: 12px;">
            <a href="A_Steadfast_Hope_Presentation.html" style="color: #fff; text-decoration: none; display: flex; align-items: center;">
              <span style="background: rgba(255,255,255,0.3); color: #fff; padding: 0.5rem 1rem; border-radius: 50%; font-weight: bold; margin-right: 1rem;">3</span>
              <span style="font-size: 1.6rem;">Part 3: A Steadfast Hope →</span>
            </a>
          </li>
        </ul>
      </div>
            </section>

            <section>
<h2>The Gospel Crisis Today</h2>
      <ul>
        <li class="fragment fade-up">Many people in Christian churches have never heard the true gospel</li>
        <li class="fragment fade-up">They've heard about behavior modification and religious duty</li>
        <li class="fragment fade-up">They've heard Jesus' name mentioned but not the gospel of grace</li>
        <li class="fragment fade-up">Result: No confidence in salvation, no assurance of eternal life</li>
        <li class="fragment fade-up">Some have never truly received Jesus as Savior and Lord</li>
        <li class="fragment fade-up">The gospel of grace is the only gospel with power to save</li>
      </ul>
            </section>

            <section>
<h1>What Is Justification?</h1>
      <h2>The Legal Foundation</h2>
            </section>

            <section>
<h2>Justification Defined</h2>
      <div class="quote">"To be justified before God is to be declared righteous or right in the eyes of the law and in the eyes of God."</div>
      <div class="subtitle" style="margin-top: 1.5rem;">Result: Set free from all punishment for your sins, both now and forever.</div>
            </section>

            <section>
<h2>The Legal Nature of Justification</h2>
      <ul>
        <li class="fragment fade-up">God made this declaration based on following the law perfectly</li>
        <li class="fragment fade-up">Love motivated God, but He followed the law to the letter</li>
        <li class="fragment fade-up">The law demanded: "Without shedding of blood, no remission"</li>
        <li class="fragment fade-up">The law didn't even bend for God - He submitted to it</li>
        <li class="fragment fade-up">Jesus fulfilled all requirements the law demanded</li>
        <li class="fragment fade-up">The law itself now declares believers "not guilty"</li>
      </ul>
            </section>

            <section>
<h2>Why Only Jesus Could Die for Us</h2>
      <ul>
        <li class="fragment fade-up">Born of a virgin - came into the world without sin</li>
        <li class="fragment fade-up">Lived 33 years in perfect obedience to the law</li>
        <li class="fragment fade-up">Satisfied the law in every way</li>
        <li class="fragment fade-up">The law found nothing to charge Him with</li>
        <li class="fragment fade-up">Therefore, the law accepted His death as substitute for ours</li>
        <li class="fragment fade-up">Muhammad, Confucius, others couldn't do it - only Jesus could</li>
      </ul>
            </section>

            <section>
<h2>The Verdict Cannot Be Reversed</h2>
      <div class="scripture">
        <p class="scripture-text">"For by one offering He has perfected forever those who are being sanctified."</p>
        <p class="scripture-ref">Hebrews 10:14</p>
      </div>
      <div class="subtitle">If the verdict could be reversed by your sin, Jesus would have wasted His blood. But He didn't - you are perfected FOREVER.</div>
            </section>

            <section>
<h2>How Justification Becomes Yours</h2>
      <ul>
        <li class="fragment fade-up">Jesus' blood is sufficient for every person who ever lived</li>
        <li class="fragment fade-up">The potential is unlimited - billions or trillions can be saved</li>
        <li class="fragment fade-up">BUT: It cannot take effect until you personally receive Jesus</li>
        <li class="fragment fade-up">No universal salvation - faith is essential</li>
        <li class="fragment fade-up">By one man (Adam) all became sinners</li>
        <li class="fragment fade-up">By one Man (Jesus) MANY shall be made righteous</li>
      </ul>
            </section>

            <section>
<h2>God's Own Righteousness</h2>
      <div class="quote">"You stand right now as righteous as God Himself. You stand right now as righteous as Jesus."</div>
      <div class="scripture">
        <p class="scripture-text">"For He made Him who knew no sin to be sin for us, that we might become the righteousness of God in Him."</p>
        <p class="scripture-ref">2 Corinthians 5:21</p>
      </div>
            </section>

            <section>
<h2>Not Just Savior, But Lord</h2>
      <ul>
        <li class="fragment fade-up">Jesus came to save us from SIN, not just from hell</li>
        <li class="fragment fade-up">The real evil is sin itself, not just its consequences</li>
        <li class="fragment fade-up">As SAVIOR: Delivers from the penalty of sin (wrath of God)</li>
        <li class="fragment fade-up">As LORD: Delivers from the power of sin (dominion)</li>
        <li class="fragment fade-up">On the cross, He dealt with the SINNER, not just sins</li>
        <li class="fragment fade-up">The old man was crucified - you have a new nature</li>
      </ul>
            </section>

            <section>
<h1>Three Treasures</h1>
      <h2>The Results of Justification</h2>
            </section>

            <section>
<h1 style="color: #ffd166;">Treasure #1</h1>
      <h2>Peace with God</h2>
      <div class="scripture">
        <p class="scripture-text">"Therefore, having been justified by faith, we have peace with God through our Lord Jesus Christ"</p>
        <p class="scripture-ref">Romans 5:1</p>
      </div>
            </section>

            <section>
<h2>What Peace with God Means</h2>
      <ul>
        <li class="fragment fade-up">Total and complete reconciliation</li>
        <li class="fragment fade-up">God holds NOTHING against you</li>
        <li class="fragment fade-up">The war has ended - God is not dropping bombs</li>
        <li class="fragment fade-up">End of hostilities and nullification of all judgment</li>
        <li class="fragment fade-up">Cancellation of all debts</li>
        <li class="fragment fade-up">Removal of all legal and relational barriers</li>
      </ul>
            </section>

            <section>
<h2>The Presence of Good Will</h2>
      <ul>
        <li class="fragment fade-up">God has granted you the status of SONS, not servants</li>
        <li class="fragment fade-up">He is actively and forcefully FOR you</li>
        <li class="fragment fade-up">He's making things work for you right now</li>
        <li class="fragment fade-up">He's resisting your enemies forcefully</li>
        <li class="fragment fade-up">He's a constant friend sticking closer than a brother</li>
        <li class="fragment fade-up">He will never leave you on your own</li>
        <li class="fragment fade-up">He loves you just as much as He loves Jesus</li>
      </ul>
            </section>

            <section>
<h2>Understanding Tribulation</h2>
      <div class="scripture">
        <p class="scripture-text">"In this world you will have tribulation; but be of good cheer, I have overcome the world."</p>
        <p class="scripture-ref">John 16:33</p>
      </div>
      <div class="subtitle">God has made peace with you. The devil has not. Know where trouble comes from!</div>
            </section>

            <section>
<h1 style="color: #ffd166;">Treasure #2</h1>
      <h2>Access to Grace</h2>
      <div class="scripture">
        <p class="scripture-text">"Through whom also we have access by faith into this grace in which we stand"</p>
        <p class="scripture-ref">Romans 5:2a</p>
      </div>
            </section>

            <section>
<h2>Living in Unmerited Favor</h2>
      <div class="quote">"I am standing, living, walking, abiding in the unmerited and undeserved favor of God."</div>
      <ul>
        <li class="fragment fade-up">I go to sleep enjoying unmerited favor</li>
        <li class="fragment fade-up">I wake up to unmerited favor</li>
        <li class="fragment fade-up">I go to work in unmerited favor</li>
        <li class="fragment fade-up">Everywhere I am, I live in, abide in, swim in grace</li>
        <li class="fragment fade-up">I know nothing but unmerited favor in Christ Jesus</li>
      </ul>
            </section>

            <section>
<h2>Grace Empowers You</h2>
      <ul>
        <li class="fragment fade-up">Grace gives you power to rule and reign in life</li>
        <li class="fragment fade-up">You will face tribulation - enemy is real, world is fallen</li>
        <li class="fragment fade-up">BUT: God is not fighting against you</li>
        <li class="fragment fade-up">If God is on your side, who can be against you?</li>
        <li class="fragment fade-up">Grace empowers you to face trials without being overcome</li>
        <li class="fragment fade-up">Standing in grace changes everything</li>
      </ul>
            </section>

            <section>
<h1 style="color: #ffd166;">Treasure #3</h1>
      <h2>Hope That Does Not Disappoint</h2>
      <div class="scripture">
        <p class="scripture-text">"And rejoice in hope of the glory of God... Now hope does not disappoint, because the love of God has been poured out in our hearts by the Holy Spirit"</p>
        <p class="scripture-ref">Romans 5:2b, 5</p>
      </div>
            </section>

            <section>
<h2>The Importance of Hope</h2>
      <ul>
        <li class="fragment fade-up">Loss of hope is at the root of most emotional problems</li>
        <li class="fragment fade-up">Depression, discouragement, loss of motivation - all rooted in hopelessness</li>
        <li class="fragment fade-up">Faith, hope, and love - all three are essential</li>
        <li class="fragment fade-up">Many Christians lose hope and experience effects of hopelessness</li>
        <li class="fragment fade-up">Earthly hopes can and do disappoint</li>
        <li class="fragment fade-up">But the hope rooted in Christ NEVER disappoints</li>
      </ul>
            </section>

            <section>
<h2>Anchor Your Soul</h2>
      <div class="quote">"That hope we should talk about is what you anchor your soul to because that one will not disappoint."</div>
      <div class="subtitle">This hope is rooted in peace with God and access to grace - it cannot fail!</div>
            </section>

            <section>
<h1>Key Scriptures</h1>
      <h2>Foundation Truths</h2>
            </section>

            <section>
<h2>No Condemnation</h2>
      <div class="scripture">
        <p class="scripture-text">"There is therefore now no condemnation to those who are in Christ Jesus."</p>
        <p class="scripture-ref">Romans 8:1</p>
      </div>
            </section>

            <section>
<h2>If God Is FOR Us</h2>
      <div class="scripture">
        <p class="scripture-text">"What then shall we say to these things? If God is for us, who can be against us? He who did not spare His own Son, but delivered Him up for us all, how shall He not with Him also freely give us all things?"</p>
        <p class="scripture-ref">Romans 8:31-32</p>
      </div>
            </section>

            <section>
<h2>Eternally Secure</h2>
      <div class="scripture">
        <p class="scripture-text">"For I am persuaded that neither death nor life, nor angels nor principalities nor powers, nor things present nor things to come, nor height nor depth, nor any other created thing, shall be able to separate us from the love of God which is in Christ Jesus our Lord."</p>
        <p class="scripture-ref">Romans 8:38-39</p>
      </div>
            </section>

            <section>
<h1>Prayer Points</h1>
      <h2>Living These Truths</h2>
            </section>

            <section>
<h2>Prayer for Clear Gospel Understanding</h2>
      <div class="prayer-points">
        <div class="scripture">
          <p class="scripture-text">"Heavenly Father, thank You for the true gospel of grace. Open the eyes of those who have never truly heard or understood it. Help them see that salvation is not by works but by faith alone in Jesus Christ. Search my own heart - help me know with certainty that I have personally received Jesus as both Savior and Lord."</p>
          <p class="scripture-ref">Based on Romans 1:16, Ephesians 2:8-9</p>
        </div>
      </div>
            </section>

            <section>
<h2>Prayer for Revelation of Legal Standing</h2>
      <div class="prayer-points">
        <div class="scripture">
          <p class="scripture-text">"Lord Jesus, thank You that justification is a legal declaration. The law itself has declared me righteous because You satisfied every demand. Help me grasp the everlasting nature of this verdict - that it can never be reversed. Let this truth anchor my soul and give me unshakable confidence."</p>
          <p class="scripture-ref">Based on Romans 5:1, Hebrews 10:14</p>
        </div>
      </div>
            </section>

            <section>
<h2>Prayer for Walking in God's Righteousness</h2>
      <div class="prayer-points">
        <div class="scripture">
          <p class="scripture-text">"Father, I declare that in Christ, I am the righteousness of God. This is not my achievement but Your gift of grace. When I pray, let me come boldly. When I face the enemy, let me declare that the righteousness of God stands here. Let this identity transform how I live."</p>
          <p class="scripture-ref">Based on 2 Corinthians 5:21, James 5:16</p>
        </div>
      </div>
            </section>

            <section>
<h2>Prayer for Living in Peace</h2>
      <div class="prayer-points">
        <div class="scripture">
          <p class="scripture-text">"Heavenly Father, thank You that I have peace with You. The war is over. You hold nothing against me. Help me reject every lie that says You are angry or disappointed. When accusations come, remind me that God is completely reconciled to me in Christ. Let this peace guard my heart."</p>
          <p class="scripture-ref">Based on Romans 5:1, Romans 8:31</p>
        </div>
      </div>
            </section>

            <section>
<h2>Prayer for Standing in Grace</h2>
      <div class="prayer-points">
        <div class="scripture">
          <p class="scripture-text">"Lord, I thank You that I stand in grace - unmerited and undeserved favor. This grace gives me power to rule and reign in life. Even though I face tribulation, grace empowers me not to be overcome. Jesus, as my Lord, break the power of sin in my life. Transform me by Your grace."</p>
          <p class="scripture-ref">Based on Romans 5:2, Philippians 2:13</p>
        </div>
      </div>
            </section>

            <section>
<h2>Prayer for Hope as Anchor</h2>
      <div class="prayer-points">
        <div class="scripture">
          <p class="scripture-text">"Father, thank You for hope that does not disappoint. This hope is rooted in my peace with You and access to Your grace. When earthly hopes fail or circumstances discourage, anchor my soul in the unchanging hope found in Christ. Protect me from depression and despair. Fill me with joy and hope."</p>
          <p class="scripture-ref">Based on Romans 5:5, Hebrews 6:19</p>
        </div>
      </div>
            </section>

            <section>
<h2>Prayer for Boldness to Share</h2>
      <div class="prayer-points">
        <div class="scripture">
          <p class="scripture-text">"Lord Jesus, the whole world needs to hear about You. Only You could die for our sins. Give me a burden for the lost. Help me proclaim clearly that salvation is by grace through faith in You alone. Give me divine appointments this week. Let me be faithful to declare that Jesus is the only way."</p>
          <p class="scripture-ref">Based on John 14:6, Romans 10:14-15</p>
        </div>
      </div>
            </section>

            <section>
<h2>Declaration of Faith</h2>
      <div class="quote">"I am justified by faith in Jesus Christ. I possess three treasures: Peace with God that can never be taken away, Access to grace that empowers me daily, and Hope that anchors my soul and never disappoints."</div>
            </section>

            <section>
<h2>Questions for Reflection</h2>
      <ul>
        <li class="fragment fade-up">Have I truly received Jesus as both Savior AND Lord?</li>
        <li class="fragment fade-up">Am I trying to earn righteousness, or resting in the gift?</li>
        <li class="fragment fade-up">Do I live with confidence that God holds nothing against me?</li>
        <li class="fragment fade-up">When I pray, do I come boldly as the righteousness of God?</li>
        <li class="fragment fade-up">Am I experiencing peace, grace, and hope in daily life?</li>
        <li class="fragment fade-up">Who needs to hear this gospel from me this week?</li>
      </ul>
            </section>

            <section>
<h2>This Week's Action Steps</h2>
      <ul>
        <li class="fragment fade-up">Memorize Romans 5:1-2 and declare it each morning</li>
        <li class="fragment fade-up">Write out 2 Corinthians 5:21 and read it when doubt arises</li>
        <li class="fragment fade-up">Identify one area where you've tried to earn God's favor</li>
        <li class="fragment fade-up">Share the gospel of justification with one person</li>
        <li class="fragment fade-up">Practice praying as "the righteousness of God in Christ"</li>
        <li class="fragment fade-up">Reject every accusation by declaring: "I am justified"</li>
        <li class="fragment fade-up">Thank God nightly for your three treasures</li>
      </ul>
            </section>

            <section>
<h2>Remember These Truths</h2>
      <ul>
        <li class="fragment fade-up"><span class="emphasis">"The law didn't bend for God - God submitted to the law"</span></li>
        <li class="fragment fade-up"><span class="emphasis">"If the verdict could be reversed, Jesus wasted His blood"</span></li>
        <li class="fragment fade-up"><span class="emphasis">"You stand as righteous as God Himself"</span></li>
        <li class="fragment fade-up"><span class="emphasis">"The war has ended - God is not dropping bombs"</span></li>
        <li class="fragment fade-up"><span class="emphasis">"God has made peace with you. The devil has not"</span></li>
        <li class="fragment fade-up"><span class="emphasis">"Hope rooted in Christ never disappoints"</span></li>
      </ul>
            </section>

            <section>
<h1>Will You Receive Him?</h1>
      <ul>
        <li class="fragment fade-up">If you have never truly received Jesus as Savior and Lord, do it today</li>
        <li class="fragment fade-up">Realize you are a sinner who cannot save yourself</li>
        <li class="fragment fade-up">Turn to the only One who can help - Jesus Christ</li>
        <li class="fragment fade-up">Trust His work on the cross as sufficient for all your sins</li>
        <li class="fragment fade-up">Receive Him as both Savior (penalty) and Lord (power)</li>
        <li class="fragment fade-up">Accept the gift of righteousness by faith</li>
      </ul>
            </section>

            <section>
<h2>Closing Prayer</h2>
      <div class="prayer-points">
        <p class="scripture-text">"Father God, thank You for this glorious gospel of grace that declares me justified by faith. Thank You for the three treasures I possess: peace with You that can never be taken away, access to grace that empowers me to live victoriously, and hope that anchors my soul and never disappoints. Help me walk in the fullness of these truths every day. Lord Jesus, You are my Savior and my Lord. Work in me both to will and to do Your good pleasure. Give me a burden for those who have never heard this gospel. In Jesus' mighty name, Amen!"</p>
        </div>
      
    

    <!-- Navigation -->
            </section>
        </div>
    </div>

    <!-- Slide Navigator Trigger Button -->
    <button class="slide-nav-trigger" aria-label="Open slide navigator" title="View all slides">
        <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <rect x="3" y="3" width="7" height="7" rx="1"/>
            <rect x="14" y="3" width="7" height="7" rx="1"/>
            <rect x="3" y="14" width="7" height="7" rx="1"/>
            <rect x="14" y="14" width="7" height="7" rx="1"/>
        </svg>
    </button>

    <!-- Slide Navigator Modal -->
    <div class="slide-nav-modal" id="slideNavModal" role="dialog" aria-label="Slide navigator" aria-modal="true">
        <div class="slide-nav-header">
            <div>
                <h2>Slide Navigator</h2>
                <span class="slide-count" id="slideNavCount"></span>
            </div>
            <button class="slide-nav-close" aria-label="Close navigator">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>
        </div>
        <div class="slide-nav-content">
            <div class="slide-nav-grid" id="slideNavGrid"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5.1.0/dist/reveal.js"></script>
    <script>
        // Responsive dimensions based on screen size
        const isMobile = window.innerWidth <= 768;
        const isSmallPhone = window.innerWidth <= 480;

        Reveal.initialize({
            width: isSmallPhone ? 375 : (isMobile ? 768 : 1920),
            height: isSmallPhone ? 667 : (isMobile ? 1024 : 1080),
            margin: isSmallPhone ? 0.02 : (isMobile ? 0.05 : 0.04),
            minScale: 0.1, maxScale: 2.0,
            hash: true, history: true, hashOneBasedIndex: true,
            controls: true, controlsTutorial: false,
            controlsLayout: 'bottom-right', controlsBackArrows: 'faded',
            progress: true, slideNumber: isMobile ? false : 'c/t', showSlideNumber: 'all',
            transition: isMobile ? 'none' : 'slide', transitionSpeed: 'fast',
            backgroundTransition: 'none',
            autoAnimate: !isMobile, autoAnimateDuration: 0.5,
            fragments: true, fragmentInURL: false,
            keyboard: true, touch: true, center: true,
            embedded: false, help: true, pause: true,
            hideInactiveCursor: true, hideCursorTime: 3000,
            disableLayout: false,
            pdfSeparateFragments: false, pdfMaxPagesPerSlide: 1,
        });
        Reveal.addKeyBinding({ keyCode: 72, key: 'H' }, () => {
            window.location.href = '../index.html';
        });
        if (new URLSearchParams(window.location.search).get('overview') === 'true') {
            Reveal.addEventListener('ready', () => Reveal.toggleOverview(true));
        }

        // Slide Navigator functionality
        (function() {
            const modal = document.getElementById('slideNavModal');
            const grid = document.getElementById('slideNavGrid');
            const countEl = document.getElementById('slideNavCount');
            const trigger = document.querySelector('.slide-nav-trigger');
            const closeBtn = document.querySelector('.slide-nav-close');

            function getSlideType(section) {
                const text = section.textContent.toLowerCase();
                const html = section.innerHTML.toLowerCase();
                if (section.querySelector('h1') && !section.querySelector('h2')) return 'title';
                if (html.includes('prayer') || html.includes('lord,') || html.includes('father,')) return 'prayer';
                if (section.querySelector('.scripture') || html.includes('scripture')) return 'scripture';
                return 'content';
            }

            function getSlideTitle(section, index) {
                const h1 = section.querySelector('h1');
                const h2 = section.querySelector('h2');
                const h3 = section.querySelector('h3');
                if (h1) return h1.textContent.trim().substring(0, 40);
                if (h2) return h2.textContent.trim().substring(0, 40);
                if (h3) return h3.textContent.trim().substring(0, 40);
                return 'Slide ' + (index + 1);
            }

            function getSlidePreview(section) {
                const h1 = section.querySelector('h1');
                const h2 = section.querySelector('h2');
                const p = section.querySelector('p');
                const scripture = section.querySelector('.scripture-text');
                let text = '';
                if (h1) text += h1.textContent.trim() + ' ';
                if (h2) text += h2.textContent.trim() + ' ';
                if (scripture) text += scripture.textContent.trim().substring(0, 80);
                else if (p) text += p.textContent.trim().substring(0, 80);
                return text.trim() || 'Slide content';
            }

            function buildNavGrid() {
                // Use Reveal.js API for reliable slide detection on all devices
                const slides = Reveal.getSlides();
                const total = Reveal.getTotalSlides();
                const current = Reveal.getIndices().h;
                countEl.textContent = total + ' slides';
                grid.innerHTML = '';

                slides.forEach((section, index) => {
                    const type = getSlideType(section);
                    const title = getSlideTitle(section, index);
                    const preview = getSlidePreview(section);
                    const isActive = index === current;

                    const card = document.createElement('div');
                    card.className = 'slide-nav-card' + (isActive ? ' active' : '');
                    card.dataset.type = type;
                    card.dataset.index = index;
                    card.setAttribute('role', 'button');
                    card.setAttribute('tabindex', '0');
                    card.setAttribute('aria-label', 'Go to slide ' + (index + 1) + ': ' + title);

                    card.innerHTML = `
                        <div class="slide-nav-preview">
                            <span class="preview-text">${preview}</span>
                        </div>
                        <div class="slide-nav-info">
                            <span class="slide-nav-number">${index + 1}</span>
                            <span class="slide-nav-title">${title}</span>
                        </div>
                    `;

                    card.addEventListener('click', () => goToSlide(index));
                    card.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            goToSlide(index);
                        }
                    });

                    grid.appendChild(card);
                });
            }

            function goToSlide(index) {
                // Use hash navigation which works in both regular and scroll view modes
                // hashOneBasedIndex is true, so we need index + 1
                const hashIndex = index + 1;
                window.location.hash = '#/' + hashIndex;
                closeModal();
            }

            function openModal() {
                buildNavGrid();
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
                closeBtn.focus();
                // Scroll to active slide
                setTimeout(() => {
                    const activeCard = grid.querySelector('.slide-nav-card.active');
                    if (activeCard) {
                        activeCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }, 100);
            }

            function closeModal() {
                modal.classList.remove('active');
                document.body.style.overflow = '';
                trigger.focus();
            }

            // Event listeners
            trigger.addEventListener('click', openModal);
            closeBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) closeModal();
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && modal.classList.contains('active')) {
                    closeModal();
                }
                // 'G' key to open navigator
                if (e.key === 'g' || e.key === 'G') {
                    if (!modal.classList.contains('active')) {
                        e.preventDefault();
                        openModal();
                    }
                }
            });

            // Update active state on slide change
            Reveal.on('slidechanged', () => {
                if (modal.classList.contains('active')) {
                    const current = Reveal.getIndices().h;
                    grid.querySelectorAll('.slide-nav-card').forEach((card, idx) => {
                        card.classList.toggle('active', idx === current);
                    });
                }
            });
        })();
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The Gospel of Grace - An expanded transformative message about peace with God through Jesus Christ by Bishop J. Darlingston">
    <title>The Gospel of Grace - Expanded Edition</title>
    <style>
        /* CSS Variables for Theming */
        :root {
            --primary-bg: #03396C;
            --secondary-bg: #1a5490;
            --accent-color: #FF8D21;
            --accent-hover: #ff6b00;
            --text-primary: white;
            --text-secondary: #FFD700;
            --panel-bg: rgba(255, 141, 33, 0.1);
            --overlay-bg: rgba(0,0,0,0.5);
            --sidebar-width: 320px;
            --animation-duration: 0.3s;
            --shadow-light: 0 2px 10px rgba(0,0,0,0.2);
            --shadow-heavy: 0 4px 15px rgba(0,0,0,0.3);
            --success-color: #4CAF50;
            --warning-color: #FFC107;
            --danger-color: #F44336;
        }

        /* Reset and Base Styles */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--primary-bg);
            color: var(--text-primary);
            overflow: hidden;
            line-height: 1.6;
        }

        /* Skip to Content Link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--accent-color);
            color: var(--text-primary);
            padding: 8px;
            text-decoration: none;
            z-index: 9999;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Sidebar Navigation */
        .sidebar {
            position: fixed;
            top: 0;
            left: calc(var(--sidebar-width) * -1);
            width: var(--sidebar-width);
            height: 100vh;
            background: rgba(3, 57, 108, 0.95);
            backdrop-filter: blur(10px);
            border-right: 2px solid var(--accent-color);
            z-index: 2000;
            transition: left var(--animation-duration) ease;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.3);
        }

        .sidebar.open {
            left: 0;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 141, 33, 0.3);
            text-align: center;
            position: sticky;
            top: 0;
            background: rgba(3, 57, 108, 0.98);
            z-index: 10;
        }

        .sidebar-header h3 {
            color: var(--accent-color);
            font-size: 1.2rem;
        }

        .sidebar-nav {
            padding: 10px 0;
        }

        .sidebar-section {
            margin: 15px 0;
            padding: 0 10px;
        }

        .sidebar-section-title {
            color: var(--text-secondary);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 5px;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
            font-size: 0.9rem;
            margin: 2px 0;
            border-radius: 0 5px 5px 0;
        }

        .sidebar-item:hover, .sidebar-item:focus {
            background: var(--panel-bg);
            border-left-color: var(--accent-color);
            outline: none;
        }

        .sidebar-item.active {
            background: rgba(255, 141, 33, 0.2);
            border-left-color: var(--accent-color);
            color: var(--accent-color);
        }

        .sidebar-item.section-break {
            background: linear-gradient(90deg, var(--accent-color), transparent);
            font-weight: bold;
            margin: 10px 0;
        }

        .sidebar-item-number {
            background: var(--accent-color);
            color: var(--primary-bg);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .sidebar-item.active .sidebar-item-number {
            background: var(--text-primary);
        }

        /* Creative Visual Elements */
        .visual-metaphor {
            position: relative;
            margin: 40px auto;
            max-width: 800px;
        }

        .bridge-visual {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
        }

        .bridge-side {
            width: 150px;
            height: 100px;
            background: linear-gradient(135deg, #666, #999);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            font-weight: bold;
            position: relative;
        }

        .bridge-gap {
            width: 200px;
            height: 4px;
            background: var(--accent-color);
            position: relative;
            animation: bridgeConnect 2s ease-in-out infinite;
        }

        @keyframes bridgeConnect {
            0%, 100% { transform: scaleX(0.5); opacity: 0.5; }
            50% { transform: scaleX(1); opacity: 1; }
        }

        .cross-bridge {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 3rem;
            color: var(--text-secondary);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.1); }
        }

        /* Journey Map */
        .journey-map {
            display: flex;
            align-items: center;
            justify-content: space-around;
            margin: 40px auto;
            max-width: 1000px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
        }

        .journey-step {
            text-align: center;
            flex: 1;
            position: relative;
            padding: 20px;
        }

        .journey-step::after {
            content: '→';
            position: absolute;
            right: -20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2rem;
            color: var(--accent-color);
        }

        .journey-step:last-child::after {
            display: none;
        }

        .journey-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .journey-title {
            color: var(--accent-color);
            font-weight: bold;
            margin-bottom: 5px;
        }

        /* Interactive Cards */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: 30px auto;
        }

        .info-card {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--accent-color);
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .info-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 141, 33, 0.2);
            box-shadow: 0 5px 20px rgba(255, 141, 33, 0.3);
        }

        .info-card-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .info-card-title {
            color: var(--accent-color);
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .info-card-content {
            font-size: 1rem;
            line-height: 1.5;
        }

        /* Timeline */
        .timeline {
            position: relative;
            max-width: 1000px;
            margin: 40px auto;
            padding: 20px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--accent-color);
        }

        .timeline-item {
            position: relative;
            width: 45%;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .timeline-item:nth-child(odd) {
            left: 0;
            text-align: right;
        }

        .timeline-item:nth-child(even) {
            left: 55%;
            text-align: left;
        }

        .timeline-dot {
            position: absolute;
            top: 30px;
            width: 20px;
            height: 20px;
            background: var(--accent-color);
            border: 3px solid var(--text-primary);
            border-radius: 50%;
        }

        .timeline-item:nth-child(odd) .timeline-dot {
            right: -60px;
        }

        .timeline-item:nth-child(even) .timeline-dot {
            left: -60px;
        }

        /* Before/After Comparison */
        .comparison {
            display: flex;
            gap: 40px;
            max-width: 1000px;
            margin: 40px auto;
        }

        .comparison-side {
            flex: 1;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
        }

        .before-side {
            background: linear-gradient(135deg, #666, #444);
            border: 2px solid #999;
        }

        .after-side {
            background: linear-gradient(135deg, var(--accent-color), var(--accent-hover));
            border: 2px solid var(--text-secondary);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(255, 215, 0, 0.3); }
            to { box-shadow: 0 0 30px rgba(255, 215, 0, 0.6); }
        }

        .comparison-title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 20px;
        }

        /* Progress Indicators */
        .progress-visual {
            max-width: 800px;
            margin: 40px auto;
        }

        .progress-bar-custom {
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-color), var(--text-secondary));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            animation: fillProgress 2s ease-out forwards;
        }

        @keyframes fillProgress {
            from { width: 0; }
            to { width: var(--progress-width); }
        }

        /* Reflection Box */
        .reflection-box {
            background: linear-gradient(135deg, rgba(255, 141, 33, 0.1), rgba(255, 215, 0, 0.1));
            border: 2px solid var(--accent-color);
            border-radius: 15px;
            padding: 30px;
            max-width: 800px;
            margin: 40px auto;
            position: relative;
        }

        .reflection-box::before {
            content: '💭';
            position: absolute;
            top: -20px;
            left: 30px;
            font-size: 2.5rem;
            background: var(--primary-bg);
            padding: 0 10px;
        }

        .reflection-prompt {
            color: var(--text-secondary);
            font-size: 1.2rem;
            font-style: italic;
            margin-bottom: 15px;
        }

        /* Action Steps */
        .action-steps {
            counter-reset: step-counter;
            max-width: 800px;
            margin: 40px auto;
        }

        .action-step {
            position: relative;
            padding: 20px 20px 20px 60px;
            margin: 15px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border-left: 4px solid var(--accent-color);
            counter-increment: step-counter;
        }

        .action-step::before {
            content: counter(step-counter);
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 30px;
            height: 30px;
            background: var(--accent-color);
            color: var(--primary-bg);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* Key Takeaways */
        .takeaways {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            max-width: 1000px;
            margin: 40px auto;
        }

        .takeaway-item {
            background: linear-gradient(135deg, rgba(255, 141, 33, 0.2), rgba(255, 141, 33, 0.1));
            border: 2px solid var(--accent-color);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .takeaway-item:hover {
            transform: scale(1.05);
        }

        .takeaway-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        /* Toggle Buttons */
        .sidebar-toggle, .help-button {
            position: fixed;
            background: var(--accent-color);
            color: var(--text-primary);
            border: none;
            padding: 12px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 2100;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--animation-duration) ease;
            box-shadow: var(--shadow-light);
        }

        .sidebar-toggle {
            top: 20px;
            left: 20px;
        }

        .help-button {
            top: 20px;
            right: 80px;
            font-size: 1.3rem;
        }

        .sidebar-toggle:hover, .help-button:hover {
            background: var(--accent-hover);
            transform: scale(1.1);
            box-shadow: var(--shadow-heavy);
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: var(--overlay-bg);
            z-index: 1900;
            opacity: 0;
            pointer-events: none;
            transition: opacity var(--animation-duration) ease;
        }

        .sidebar-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        /* Help Modal */
        .help-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--primary-bg);
            border: 2px solid var(--accent-color);
            border-radius: 15px;
            padding: 30px;
            z-index: 3000;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        }

        .help-modal.active {
            display: block;
        }

        .help-modal h3 {
            color: var(--accent-color);
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .help-modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--accent-color);
            color: var(--text-primary);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .keyboard-shortcuts {
            margin-top: 20px;
        }

        .shortcut-group {
            margin-bottom: 15px;
        }

        .shortcut-group h4 {
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .shortcut {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
        }

        .shortcut kbd {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 8px;
            border-radius: 4px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            font-family: monospace;
        }

        /* Presentation Container */
        .presentation {
            width: 100vw;
            height: 100vh;
            position: relative;
            transition: margin-left var(--animation-duration) ease;
        }

        /* Individual Slide Styles */
        .slide {
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 60px;
            text-align: center;
            position: relative;
            background: linear-gradient(135deg, var(--primary-bg) 0%, var(--secondary-bg) 100%);
            overflow-y: auto;
        }

        .slide.active {
            display: flex;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Typography */
        .slide h1 {
            font-size: clamp(2.5rem, 5vw, 4.5rem);
            font-weight: 700;
            margin-bottom: 40px;
            color: var(--accent-color);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            line-height: 1.2;
        }

        .slide h2 {
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: 600;
            margin-bottom: 30px;
            color: var(--text-primary);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .slide h3 {
            font-size: clamp(1.5rem, 3vw, 2.2rem);
            font-weight: 500;
            margin-bottom: 25px;
            color: var(--accent-color);
        }

        .slide p {
            font-size: clamp(1.2rem, 2vw, 1.8rem);
            line-height: 1.6;
            margin-bottom: 20px;
            max-width: 900px;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.4rem;
            margin-top: 20px;
        }

        /* Scripture Styling */
        .scripture {
            font-size: clamp(1.5rem, 2.5vw, 2.2rem);
            font-style: italic;
            color: var(--text-secondary);
            margin: 30px auto;
            padding: 30px;
            border-left: 5px solid var(--accent-color);
            background: var(--panel-bg);
            border-radius: 10px;
            max-width: 1000px;
            position: relative;
        }

        .scripture-reference {
            font-size: 1.4rem;
            color: var(--accent-color);
            margin-top: 15px;
            font-weight: 600;
            font-style: normal;
        }

        .quote {
            font-size: clamp(1.8rem, 3vw, 2.5rem);
            font-weight: 600;
            color: var(--accent-color);
            margin: 40px auto;
            padding: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            border: 2px solid var(--accent-color);
            max-width: 1000px;
        }

        /* Lists */
        .bullet-list {
            text-align: left;
            max-width: 1000px;
            margin: 0 auto;
            list-style: none;
        }

        .bullet-list li {
            font-size: clamp(1.2rem, 2vw, 1.8rem);
            margin: 20px 0;
            padding-left: 40px;
            position: relative;
        }

        .bullet-list li::before {
            content: "▶";
            color: var(--accent-color);
            font-size: 1.2em;
            position: absolute;
            left: 0;
        }

        /* Section Breaks */
        .section-break {
            background: linear-gradient(45deg, var(--accent-color), #ffb366);
            color: var(--primary-bg);
        }

        .section-break h1 {
            color: var(--primary-bg);
            font-size: clamp(3rem, 6vw, 5rem);
            text-shadow: 2px 2px 4px rgba(255,255,255,0.3);
        }

        /* Call to Action */
        .cta {
            background: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-hover) 100%);
        }

        .cta h1 {
            color: var(--text-primary);
        }

        /* Navigation Controls */
        .nav-controls {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }

        .nav-button, .home-button {
            background: var(--accent-color);
            color: var(--text-primary);
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all var(--animation-duration) ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .nav-button:hover:not(:disabled), .home-button:hover {
            background: var(--accent-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-heavy);
        }

        .nav-button:disabled {
            background: rgba(255, 141, 33, 0.5);
            cursor: not-allowed;
        }

        .nav-button:focus, .home-button:focus {
            outline: 2px solid var(--text-secondary);
            outline-offset: 2px;
        }

        .home-button {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2100;
        }

        /* Progress and Counter */
        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background: var(--accent-color);
            transition: width var(--animation-duration) ease;
            z-index: 1000;
        }

        .slide-counter {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: rgba(255, 141, 33, 0.9);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 1rem;
        }

        /* Two Column Layout */
        .two-column {
            display: flex;
            gap: 60px;
            align-items: flex-start;
            max-width: 1200px;
            margin: 0 auto;
        }

        .column {
            flex: 1;
            text-align: left;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                width: 280px;
            }

            .slide {
                padding: 30px 20px;
            }

            .two-column, .comparison, .journey-map {
                flex-direction: column;
                gap: 30px;
            }

            .timeline::before {
                left: 30px;
            }

            .timeline-item {
                width: 100%;
                left: 0 !important;
                padding-left: 70px;
                text-align: left !important;
            }

            .timeline-dot {
                left: 20px !important;
            }

            .nav-controls {
                bottom: 20px;
                right: 20px;
            }

            .home-button {
                top: 70px;
                right: 15px;
                padding: 10px 15px;
            }

            .home-button span:not(.home-button-icon) {
                display: none;
            }

            .help-button {
                right: 70px;
            }

            .help-modal {
                width: 90%;
                max-width: none;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Print Styles */
        @media print {
            .slide {
                display: flex !important;
                page-break-after: always;
                height: auto;
                min-height: 100vh;
                background: white !important;
                color: var(--primary-bg) !important;
            }

            .nav-controls, .slide-counter, .progress-bar,
            .home-button, .sidebar-toggle, .help-button, .sidebar {
                display: none !important;
            }

            .slide h1, .quote {
                color: var(--accent-color) !important;
            }

            .scripture {
                color: var(--primary-bg) !important;
            }
        }

        /* Focus Visible for Accessibility */
        :focus-visible {
            outline: 2px solid var(--text-secondary);
            outline-offset: 2px;
        }

        /* Reduced Motion Support */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Skip to Content Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Sidebar Toggle Button -->
    <button class="sidebar-toggle" onclick="toggleSidebar()" aria-label="Toggle navigation menu" aria-expanded="false">
        <span aria-hidden="true">☰</span>
    </button>

    <!-- Help Button -->
    <button class="help-button" onclick="toggleHelp()" aria-label="Show keyboard shortcuts and help">
        <span aria-hidden="true">?</span>
    </button>

    <!-- Help Modal -->
    <div class="help-modal" id="helpModal" role="dialog" aria-labelledby="help-title" aria-hidden="true">
        <button class="help-modal-close" onclick="toggleHelp()" aria-label="Close help dialog">×</button>
        <h3 id="help-title">Presentation Controls</h3>

        <div class="keyboard-shortcuts">
            <div class="shortcut-group">
                <h4>Navigation</h4>
                <div class="shortcut">
                    <span>Next slide</span>
                    <kbd>→</kbd> <kbd>↓</kbd> <kbd>Space</kbd>
                </div>
                <div class="shortcut">
                    <span>Previous slide</span>
                    <kbd>←</kbd> <kbd>↑</kbd>
                </div>
                <div class="shortcut">
                    <span>First slide</span>
                    <kbd>Home</kbd>
                </div>
                <div class="shortcut">
                    <span>Last slide</span>
                    <kbd>End</kbd>
                </div>
            </div>

            <div class="shortcut-group">
                <h4>Display</h4>
                <div class="shortcut">
                    <span>Toggle navigation menu</span>
                    <kbd>M</kbd>
                </div>
                <div class="shortcut">
                    <span>Toggle fullscreen</span>
                    <kbd>F</kbd>
                </div>
                <div class="shortcut">
                    <span>Close dialogs</span>
                    <kbd>Esc</kbd>
                </div>
                <div class="shortcut">
                    <span>Show this help</span>
                    <kbd>?</kbd> <kbd>H</kbd>
                </div>
            </div>

            <div class="shortcut-group">
                <h4>Quick Jump</h4>
                <div class="shortcut">
                    <span>Jump to slide</span>
                    <kbd>G</kbd> then number
                </div>
            </div>
        </div>
    </div>

    <!-- Home Button -->
    <a href="../index.html" class="home-button" aria-label="Return to Dashboard">
        <span class="home-button-icon" aria-hidden="true">🏠</span>
        <span>Dashboard</span>
    </a>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" onclick="closeSidebar()" aria-hidden="true"></div>

    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar" role="navigation" aria-label="Slide navigation">
        <div class="sidebar-header">
            <h3>Slide Navigation</h3>
        </div>
        <div class="sidebar-nav" id="sidebarNav" role="list">
            <!-- Navigation items will be generated by JavaScript -->
        </div>
    </nav>

    <main class="presentation" id="presentation" role="main" id="main-content">
        <div class="progress-bar" id="progressBar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>

        <!-- Slide 1: Title Slide -->
        <section class="slide active" aria-hidden="false">
            <h1>The Gospel of Grace</h1>
            <h2>Peace with God Through Jesus Christ</h2>
            <div class="scripture">
                "Therefore, having been justified by faith, we have peace with God through our Lord Jesus Christ"
                <div class="scripture-reference">Romans 5:1-2</div>
            </div>
            <p style="margin-top: 40px; font-size: 1.6rem; color: var(--accent-color);">Bishop J. Darlingston</p>
            <p style="margin-top: 20px; font-size: 1.4rem; color: var(--text-secondary);">September 21, 2025</p>
            <p style="margin-top: 20px; font-size: 1.3rem;">A Life-Changing Message of Hope and Transformation</p>
        </section>

        <!-- Slide 2: Opening Reflection -->
        <section class="slide" aria-hidden="true">
            <h2>A Moment of Reflection</h2>
            <div class="reflection-box">
                <p class="reflection-prompt">Before we begin this journey, consider:</p>
                <ul class="bullet-list">
                    <li>Have you ever felt distant from God?</li>
                    <li>Do you struggle with feeling "good enough" for His love?</li>
                    <li>Are you searching for lasting peace in your heart?</li>
                    <li>Do you wonder if God is truly on your side?</li>
                </ul>
            </div>
            <p style="margin-top: 30px; color: var(--text-secondary); font-size: 1.5rem;">
                Today's message will answer these questions with life-changing truth...
            </p>
        </section>

        <!-- Slide 3: Prayer Focus Overview -->
        <section class="slide" aria-hidden="true">
            <h2>This Week's Prayer Focus</h2>
            <div class="card-grid">
                <div class="info-card">
                    <div class="info-card-icon">✝️</div>
                    <div class="info-card-title">Peace Child Declaration</div>
                    <div class="info-card-content">Romans 5:1 - Jesus is our Peace Child bringing eternal reconciliation</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">⚖️</div>
                    <div class="info-card-title">Legal Standing</div>
                    <div class="info-card-content">Romans 8:33-34 - No condemnation remains for those in Christ</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">🛡️</div>
                    <div class="info-card-title">God Is FOR Us</div>
                    <div class="info-card-content">Romans 8:31 - If God is for us, who can be against us?</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">🏠</div>
                    <div class="info-card-title">Complete Restoration</div>
                    <div class="info-card-content">Luke 15 - Treated as though we never left home</div>
                </div>
            </div>
        </section>

        <!-- Slide 4: Foundation Scripture -->
        <section class="slide" aria-hidden="true">
            <h2>Our Foundation Scripture</h2>
            <div class="scripture">
                "Therefore, having been justified by faith, we have peace with God through our Lord Jesus Christ, through whom also we have access by faith into this grace in which we stand, and rejoice in hope of the glory of God."
                <div class="scripture-reference">Romans 5:1-2</div>
            </div>
            <div class="takeaways">
                <div class="takeaway-item">
                    <div class="takeaway-icon">📜</div>
                    <strong>Justified</strong><br>Declared righteous
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">🕊️</div>
                    <strong>Peace</strong><br>War has ended
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">🚪</div>
                    <strong>Access</strong><br>Door is open
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">💫</div>
                    <strong>Grace</strong><br>Empowered to change
                </div>
            </div>
        </section>

        <!-- Slide 5: Section Break - Peace Child -->
        <section class="slide section-break" aria-hidden="true">
            <h1>Part 1: The Peace Child Story</h1>
            <h2>A Cultural Bridge to the Gospel</h2>
            <p class="subtitle">How God Reveals Himself Through Every Culture</p>
        </section>

        <!-- Slide 6: The Mission Field -->
        <section class="slide" aria-hidden="true">
            <h2>The Missionary's Challenge</h2>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>The Arrival</h3>
                    <p>Missionaries arrive among the Sawi people of South America with hearts full of hope</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>The Discovery</h3>
                    <p>They find a culture where betrayal is celebrated as the highest virtue</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>The Dilemma</h3>
                    <p>Judas becomes the hero, not Jesus - how can the Gospel be shared?</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>The Prayer</h3>
                    <p>Desperate prayer for wisdom to bridge this cultural chasm</p>
                </div>
            </div>
        </section>

        <!-- Slide 7: Cultural Context -->
        <section class="slide" aria-hidden="true">
            <h2>Understanding the Sawi Worldview</h2>
            <div class="comparison">
                <div class="comparison-side before-side">
                    <div class="comparison-title">Sawi Values</div>
                    <ul class="bullet-list">
                        <li>Betrayal = Cleverness</li>
                        <li>Deception = Wisdom</li>
                        <li>Trust = Weakness</li>
                        <li>Judas = Hero</li>
                    </ul>
                </div>
                <div class="comparison-side after-side">
                    <div class="comparison-title">Gospel Values</div>
                    <ul class="bullet-list">
                        <li>Faithfulness = Love</li>
                        <li>Truth = Freedom</li>
                        <li>Trust = Strength</li>
                        <li>Jesus = Savior</li>
                    </ul>
                </div>
            </div>
            <p style="margin-top: 30px; font-size: 1.5rem;">How could these opposing worldviews ever meet?</p>
        </section>

        <!-- Slide 8: The Breakthrough Discovery -->
        <section class="slide" aria-hidden="true">
            <h2>God's Wisdom Revealed</h2>
            <div class="journey-map">
                <div class="journey-step">
                    <div class="journey-icon">⚔️</div>
                    <div class="journey-title">Warring Tribes</div>
                    <p>Endless conflict and bloodshed</p>
                </div>
                <div class="journey-step">
                    <div class="journey-icon">👑</div>
                    <div class="journey-title">King's Decision</div>
                    <p>A father makes an unthinkable choice</p>
                </div>
                <div class="journey-step">
                    <div class="journey-icon">👶</div>
                    <div class="journey-title">Peace Child Given</div>
                    <p>His own son becomes the bridge</p>
                </div>
                <div class="journey-step">
                    <div class="journey-icon">🕊️</div>
                    <div class="journey-title">Peace Secured</div>
                    <p>As long as the child lives, peace remains</p>
                </div>
            </div>
        </section>

        <!-- Slide 9: The Peace Child Principle -->
        <section class="slide" aria-hidden="true">
            <h2>The Peace Child Covenant</h2>
            <div class="visual-metaphor">
                <div class="bridge-visual">
                    <div class="bridge-side">Tribe A<br>WAR</div>
                    <div class="bridge-gap">
                        <span class="cross-bridge">👶</span>
                    </div>
                    <div class="bridge-side">Tribe B<br>WAR</div>
                </div>
            </div>
            <div class="quote">
                "The Peace Child transforms enemies into family"
            </div>
            <ul class="bullet-list">
                <li>The child represents total vulnerability and trust</li>
                <li>Breaking this covenant means eternal shame</li>
                <li>The two tribes become one people through the child</li>
                <li>This was their highest form of reconciliation</li>
            </ul>
        </section>

        <!-- Slide 10: The Gospel Connection -->
        <section class="slide" aria-hidden="true">
            <h2>The Divine Revelation</h2>
            <div class="quote">
                "Tell them Jesus is God's Peace Child!"
            </div>
            <div class="reflection-box">
                <p>Suddenly, everything clicked into place:</p>
                <ul class="bullet-list">
                    <li>God the Father gave His only Son</li>
                    <li>Jesus bridged the gap between God and humanity</li>
                    <li>As long as Jesus lives (forever!), peace remains</li>
                    <li>We become God's family through Christ</li>
                </ul>
            </div>
        </section>

        <!-- Slide 11: Jesus Our Peace Child -->
        <section class="slide" aria-hidden="true">
            <h2>Jesus: The Ultimate Peace Child</h2>
            <div class="bridge-visual">
                <div class="bridge-side">HOLY GOD<br>Justice</div>
                <div class="bridge-gap">
                    <span class="cross-bridge">✝️</span>
                </div>
                <div class="bridge-side">SINFUL MAN<br>Rebellion</div>
            </div>
            <div class="action-steps">
                <div class="action-step">War existed between God and humanity for thousands of years</div>
                <div class="action-step">God initiated the peace process - we didn't seek Him</div>
                <div class="action-step">He gave His most precious possession - His only Son</div>
                <div class="action-step">Jesus became vulnerable, taking our place</div>
                <div class="action-step">His resurrection ensures eternal peace</div>
            </div>
        </section>

        <!-- Slide 12: Personal Application -->
        <section class="slide" aria-hidden="true">
            <h2>What This Means For You</h2>
            <div class="quote">
                "You are no longer God's enemy - you are His child"
            </div>
            <div class="card-grid">
                <div class="info-card">
                    <div class="info-card-icon">🎯</div>
                    <div class="info-card-title">Before Christ</div>
                    <div class="info-card-content">Enemy of God, under wrath, separated, condemned</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">✨</div>
                    <div class="info-card-title">In Christ</div>
                    <div class="info-card-content">Child of God, under grace, united, justified</div>
                </div>
            </div>
        </section>

        <!-- Slide 13: Section Break - War Has Ended -->
        <section class="slide section-break" aria-hidden="true">
            <h1>Part 2: The War Has Ended</h1>
            <h2>Understanding Your New Reality</h2>
            <p class="subtitle">The Bombs Have Stopped Falling</p>
        </section>

        <!-- Slide 14: The Cessation of Hostilities -->
        <section class="slide" aria-hidden="true">
            <h2>A Powerful Metaphor</h2>
            <div class="visual-metaphor">
                <div class="progress-visual">
                    <h3>Status of War with God:</h3>
                    <div class="progress-bar-custom">
                        <div class="progress-fill" style="--progress-width: 100%;">
                            PEACE DECLARED - WAR ENDED
                        </div>
                    </div>
                </div>
            </div>
            <div class="quote">
                "The bombs have stopped falling - the war is over!"
            </div>
            <p>Imagine living in a war zone, then suddenly... silence. Peace. Safety.</p>
        </section>

        <!-- Slide 15: What Peace Looks Like -->
        <section class="slide" aria-hidden="true">
            <h2>Your New Reality in Christ</h2>
            <div class="comparison">
                <div class="comparison-side before-side">
                    <div class="comparison-title">❌ No Longer True</div>
                    <ul class="bullet-list">
                        <li>God is angry with you</li>
                        <li>He's keeping score</li>
                        <li>He's waiting to punish</li>
                        <li>You must earn His love</li>
                        <li>He's disappointed</li>
                    </ul>
                </div>
                <div class="comparison-side after-side">
                    <div class="comparison-title">✅ Now True</div>
                    <ul class="bullet-list">
                        <li>God is pleased with you</li>
                        <li>Your sins are forgotten</li>
                        <li>He's eager to bless</li>
                        <li>His love is unconditional</li>
                        <li>He delights in you</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Slide 16: God's Heart Toward You -->
        <section class="slide" aria-hidden="true">
            <h2>How God Sees You Now</h2>
            <div class="takeaways">
                <div class="takeaway-item">
                    <div class="takeaway-icon">❤️</div>
                    <strong>Beloved</strong><br>Deeply loved child
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">👑</div>
                    <strong>Royalty</strong><br>Heir to the Kingdom
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">💎</div>
                    <strong>Precious</strong><br>Worth Jesus' blood
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">🌟</div>
                    <strong>Chosen</strong><br>Handpicked by God
                </div>
            </div>
            <p style="margin-top: 30px; font-size: 1.6rem; color: var(--text-secondary);">
                "He's not tolerating you - He's celebrating you!"
            </p>
        </section>

        <!-- Slide 17: Section Break - God Is FOR You -->
        <section class="slide section-break" aria-hidden="true">
            <h1>Part 3: God Is FOR You</h1>
            <h2>Romans 8:31-39</h2>
            <p class="subtitle">The Most Powerful Truth You'll Ever Hear</p>
        </section>

        <!-- Slide 18: The Great Question -->
        <section class="slide" aria-hidden="true">
            <h2>What Then Shall We Say?</h2>
            <div class="scripture">
                "What then shall we say to these things? If God is for us, who can be against us?"
                <div class="scripture-reference">Romans 8:31</div>
            </div>
            <div class="reflection-box">
                <p class="reflection-prompt">Let this sink in:</p>
                <p style="font-size: 2rem; color: var(--accent-color);">
                    The Creator of the universe is actively, personally, powerfully FOR YOU!
                </p>
            </div>
        </section>

        <!-- Slide 19: The Ultimate Proof -->
        <section class="slide" aria-hidden="true">
            <h2>How Can We Be Sure?</h2>
            <div class="scripture">
                "He who did not spare His own Son, but delivered Him up for us all, how shall He not with Him also freely give us all things?"
                <div class="scripture-reference">Romans 8:32</div>
            </div>
            <div class="visual-metaphor">
                <h3 style="margin-bottom: 30px;">The Logic of Love:</h3>
                <div class="action-steps">
                    <div class="action-step">If God gave His most precious treasure (Jesus)...</div>
                    <div class="action-step">Why would He withhold lesser things?</div>
                    <div class="action-step">If He solved your biggest problem (sin)...</div>
                    <div class="action-step">Won't He handle your smaller ones?</div>
                </div>
            </div>
        </section>

        <!-- Slide 20: No Accusations Can Stand -->
        <section class="slide" aria-hidden="true">
            <h2>Secure from All Accusations</h2>
            <div class="scripture">
                "Who shall bring a charge against God's elect? It is God who justifies. Who is he who condemns? It is Christ who died, and furthermore is also risen, who is even at the right hand of God, who also makes intercession for us."
                <div class="scripture-reference">Romans 8:33-34</div>
            </div>
            <div class="info-card" style="max-width: 800px; margin: 30px auto;">
                <div class="info-card-icon">⚖️</div>
                <div class="info-card-title">Your Divine Legal Team</div>
                <div class="info-card-content">
                    <ul class="bullet-list">
                        <li>God the Judge declares you "NOT GUILTY"</li>
                        <li>Jesus the Lawyer defends you</li>
                        <li>The Holy Spirit testifies for you</li>
                        <li>Case closed - permanently!</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Slide 21: Nothing Can Separate -->
        <section class="slide" aria-hidden="true">
            <h2>Eternally Secure</h2>
            <div class="scripture">
                "For I am persuaded that neither death nor life, nor angels nor principalities nor powers, nor things present nor things to come, nor height nor depth, nor any other created thing, shall be able to separate us from the love of God which is in Christ Jesus our Lord."
                <div class="scripture-reference">Romans 8:38-39</div>
            </div>
            <div class="quote">
                "God's love for you is stronger than anything in the universe!"
            </div>
        </section>

        <!-- Slide 22: What Can't Separate You -->
        <section class="slide" aria-hidden="true">
            <h2>The Unbreakable Bond</h2>
            <div class="card-grid">
                <div class="info-card">
                    <div class="info-card-icon">💀</div>
                    <div class="info-card-title">Not Death</div>
                    <div class="info-card-content">It only brings you closer to Him</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">🌍</div>
                    <div class="info-card-title">Not Life</div>
                    <div class="info-card-content">No circumstance can break His love</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">👹</div>
                    <div class="info-card-title">Not Demons</div>
                    <div class="info-card-content">They cannot snatch you from His hand</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">⏰</div>
                    <div class="info-card-title">Not Time</div>
                    <div class="info-card-content">Past, present, or future - you're secure</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">🌌</div>
                    <div class="info-card-title">Not Space</div>
                    <div class="info-card-content">No distance can separate you</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">❓</div>
                    <div class="info-card-title">Not Anything</div>
                    <div class="info-card-content">Literally nothing in creation!</div>
                </div>
            </div>
        </section>

        <!-- Slide 23: Section Break - Legal Foundation -->
        <section class="slide section-break" aria-hidden="true">
            <h1>Part 4: The Legal Foundation</h1>
            <h2>Not Emotional, But Legal</h2>
            <p class="subtitle">Your Peace Has a Legal Deed</p>
        </section>

        <!-- Slide 24: Why Legal Matters -->
        <section class="slide" aria-hidden="true">
            <h2>God Respects His Own Law</h2>
            <div class="reflection-box">
                <p class="reflection-prompt">Understanding the legal aspect changes everything:</p>
                <ul class="bullet-list">
                    <li>Feelings fluctuate - legal standing doesn't</li>
                    <li>Emotions lie - legal documents don't</li>
                    <li>Circumstances change - legal verdicts remain</li>
                    <li>You may doubt - the law stands firm</li>
                </ul>
            </div>
            <div class="quote">
                "Your salvation is as legally binding as God's own character"
            </div>
        </section>

        <!-- Slide 25: The Law's Requirements -->
        <section class="slide" aria-hidden="true">
            <h2>What the Law Demanded</h2>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>Perfect Obedience</h3>
                    <p>"Be holy as I am holy" - No one could achieve this</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>Death for Sin</h3>
                    <p>"The soul that sins shall die" - Justice must be served</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>Blood Sacrifice</h3>
                    <p>"Without shedding of blood, no remission" - Payment required</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>Spotless Substitute</h3>
                    <p>"Without blemish" - Only perfection could satisfy</p>
                </div>
            </div>
        </section>

        <!-- Slide 26: Christ's Qualification -->
        <section class="slide" aria-hidden="true">
            <h2>Jesus Met Every Requirement</h2>
            <div class="progress-visual">
                <h3>Christ's Legal Qualifications:</h3>
                <div style="margin: 20px 0;">
                    <div class="progress-bar-custom" style="margin: 10px 0;">
                        <div class="progress-fill" style="--progress-width: 100%;">
                            ✓ Sinless Life - 100% Complete
                        </div>
                    </div>
                    <div class="progress-bar-custom" style="margin: 10px 0;">
                        <div class="progress-fill" style="--progress-width: 100%;">
                            ✓ Perfect Obedience - 100% Complete
                        </div>
                    </div>
                    <div class="progress-bar-custom" style="margin: 10px 0;">
                        <div class="progress-fill" style="--progress-width: 100%;">
                            ✓ Substitutionary Death - 100% Complete
                        </div>
                    </div>
                    <div class="progress-bar-custom" style="margin: 10px 0;">
                        <div class="progress-fill" style="--progress-width: 100%;">
                            ✓ Resurrection Victory - 100% Complete
                        </div>
                    </div>
                </div>
            </div>
            <p style="margin-top: 30px; font-size: 1.8rem; color: var(--text-secondary);">
                Verdict: QUALIFIED! Case CLOSED!
            </p>
        </section>

        <!-- Slide 27: Your Legal Deed -->
        <section class="slide" aria-hidden="true">
            <h2>You Have a Legal Deed</h2>
            <div class="info-card" style="max-width: 800px; margin: 30px auto;">
                <div class="info-card-icon">📜</div>
                <div class="info-card-title">Your Deed of Peace</div>
                <div class="info-card-content" style="text-align: left;">
                    <p><strong>Property:</strong> Peace with God</p>
                    <p><strong>Owner:</strong> [Your name here]</p>
                    <p><strong>Purchase Price:</strong> The blood of Jesus Christ</p>
                    <p><strong>Date of Transfer:</strong> The moment you believed</p>
                    <p><strong>Guarantor:</strong> God the Father</p>
                    <p><strong>Witnesses:</strong> The Holy Spirit</p>
                    <p><strong>Duration:</strong> Eternal - Never expires</p>
                </div>
            </div>
            <div class="quote">
                "This peace is mine legally!"
            </div>
        </section>

        <!-- Slide 28: The Divine Courtroom -->
        <section class="slide" aria-hidden="true">
            <h2>The Heavenly Court Scene</h2>
            <div class="visual-metaphor">
                <div style="text-align: center; margin: 40px auto; max-width: 900px;">
                    <h3 style="color: var(--text-secondary); margin-bottom: 30px;">⚖️ Divine Court of Justice ⚖️</h3>
                    <div class="action-steps">
                        <div class="action-step">The Judge (God) examines the evidence</div>
                        <div class="action-step">The Prosecutor (Satan) brings accusations</div>
                        <div class="action-step">The Defense (Jesus) presents His blood</div>
                        <div class="action-step">The Judge reviews Christ's perfect record</div>
                        <div class="action-step">The gavel falls: "NOT GUILTY! CASE DISMISSED!"</div>
                    </div>
                </div>
            </div>
            <p style="margin-top: 30px; font-size: 1.6rem; color: var(--accent-color);">
                "There is therefore now NO condemnation!" (Romans 8:1)
            </p>
        </section>

        <!-- Slide 29: Section Break - Prodigal Son -->
        <section class="slide section-break" aria-hidden="true">
            <h1>Part 5: The Prodigal Son</h1>
            <h2>A Picture of Grace</h2>
            <p class="subtitle">How God Receives Those Who Return</p>
        </section>

        <!-- Slide 30: The Son's Journey -->
        <section class="slide" aria-hidden="true">
            <h2>The Journey Away and Back</h2>
            <div class="journey-map">
                <div class="journey-step">
                    <div class="journey-icon">🏠</div>
                    <div class="journey-title">Home</div>
                    <p>Safety & love</p>
                </div>
                <div class="journey-step">
                    <div class="journey-icon">🚪</div>
                    <div class="journey-title">Departure</div>
                    <p>"Give me my share"</p>
                </div>
                <div class="journey-step">
                    <div class="journey-icon">🎭</div>
                    <div class="journey-title">Wild Living</div>
                    <p>Wasted everything</p>
                </div>
                <div class="journey-step">
                    <div class="journey-icon">🐷</div>
                    <div class="journey-title">Rock Bottom</div>
                    <p>Feeding pigs</p>
                </div>
                <div class="journey-step">
                    <div class="journey-icon">💡</div>
                    <div class="journey-title">Awakening</div>
                    <p>"I will arise"</p>
                </div>
            </div>
        </section>

        <!-- Slide 31: The Father's Heart -->
        <section class="slide" aria-hidden="true">
            <h2>The Father Was Watching</h2>
            <div class="reflection-box">
                <p class="reflection-prompt">Picture this scene:</p>
                <ul class="bullet-list">
                    <li>Every day, the father climbed to the roof</li>
                    <li>He scanned the horizon, hoping</li>
                    <li>His heart ached for his lost child</li>
                    <li>He never gave up watching, waiting</li>
                </ul>
            </div>
            <div class="quote">
                "While he was still a far way off, his father saw him..."
            </div>
            <p style="color: var(--text-secondary); font-size: 1.5rem;">
                God is watching for you with that same longing heart!
            </p>
        </section>

        <!-- Slide 32: The Running Father -->
        <section class="slide" aria-hidden="true">
            <h2>Dignity Laid Aside</h2>
            <div class="visual-metaphor">
                <h3 style="color: var(--accent-color); margin-bottom: 30px;">Cultural Shock:</h3>
                <div class="info-card" style="max-width: 800px; margin: 30px auto;">
                    <div class="info-card-content">
                        <p>In Middle Eastern culture, dignified men NEVER run.</p>
                        <p>To run, he had to hike up his robes, exposing his legs.</p>
                        <p>This was considered shameful and undignified.</p>
                        <p style="font-size: 1.5rem; color: var(--accent-color); margin-top: 20px;">
                            But love made him run anyway!
                        </p>
                    </div>
                </div>
            </div>
            <div class="quote">
                "Grace runs to meet you while you're still far off"
            </div>
        </section>

        <!-- Slide 33: Complete Restoration -->
        <section class="slide" aria-hidden="true">
            <h2>Treated As If He Never Left</h2>
            <div class="card-grid">
                <div class="info-card">
                    <div class="info-card-icon">👔</div>
                    <div class="info-card-title">Best Robe</div>
                    <div class="info-card-content">Covering of righteousness - honor restored</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">💍</div>
                    <div class="info-card-title">Ring</div>
                    <div class="info-card-content">Authority of sonship - family seal</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">👟</div>
                    <div class="info-card-title">Shoes</div>
                    <div class="info-card-content">Not a servant but a son - full privileges</div>
                </div>
                <div class="info-card">
                    <div class="info-card-icon">🎉</div>
                    <div class="info-card-title">Celebration</div>
                    <div class="info-card-content">Joy in heaven - the lost is found!</div>
                </div>
            </div>
        </section>

        <!-- Slide 34: Your Story -->
        <section class="slide" aria-hidden="true">
            <h2>This Is YOUR Story</h2>
            <div class="comparison">
                <div class="comparison-side before-side">
                    <div class="comparison-title">The Son's Expectations</div>
                    <ul class="bullet-list">
                        <li>"Make me a servant"</li>
                        <li>"I'm not worthy"</li>
                        <li>"I'll earn my way back"</li>
                        <li>"Maybe partial forgiveness"</li>
                    </ul>
                </div>
                <div class="comparison-side after-side">
                    <div class="comparison-title">The Father's Response</div>
                    <ul class="bullet-list">
                        <li>"You're my beloved child"</li>
                        <li>"You're fully restored"</li>
                        <li>"Everything I have is yours"</li>
                        <li>"Complete celebration!"</li>
                    </ul>
                </div>
            </div>
            <p style="margin-top: 30px; font-size: 1.6rem; color: var(--text-secondary);">
                God's grace always exceeds our expectations!
            </p>
        </section>

        <!-- Slide 35: Section Break - Access to Grace -->
        <section class="slide section-break" aria-hidden="true">
            <h1>Part 6: Access to Grace</h1>
            <h2>Standing in Transformation</h2>
            <p class="subtitle">Grace That Changes Everything</p>
        </section>

        <!-- Slide 36: More Than Forgiveness -->
        <section class="slide" aria-hidden="true">
            <h2>Peace PLUS Access</h2>
            <div class="scripture">
                "Through whom also we have access by faith into this grace in which we stand"
                <div class="scripture-reference">Romans 5:2</div>
            </div>
            <div class="visual-metaphor">
                <h3 style="margin-bottom: 30px;">You Have Been Given:</h3>
                <div class="takeaways">
                    <div class="takeaway-item">
                        <div class="takeaway-icon">🕊️</div>
                        <strong>Peace</strong><br>War ended
                    </div>
                    <div class="takeaway-item">
                        <div class="takeaway-icon">➕</div>
                        <strong>PLUS</strong><br>
                    </div>
                    <div class="takeaway-item">
                        <div class="takeaway-icon">🚪</div>
                        <strong>Access</strong><br>Door opened
                    </div>
                    <div class="takeaway-item">
                        <div class="takeaway-icon">=</div>
                        <strong>EQUALS</strong><br>
                    </div>
                    <div class="takeaway-item">
                        <div class="takeaway-icon">✨</div>
                        <strong>Transformation</strong><br>Life changed
                    </div>
                </div>
            </div>
        </section>

        <!-- Slide 37: How Grace Works -->
        <section class="slide" aria-hidden="true">
            <h2>The Power of Grace</h2>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>Grace Enters</h3>
                    <p>You receive Christ and His nature</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>Grace Teaches</h3>
                    <p>Your desires begin to change</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>Grace Empowers</h3>
                    <p>You can do what you couldn't before</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-dot"></div>
                    <h3>Grace Transforms</h3>
                    <p>You become like Christ</p>
                </div>
            </div>
        </section>

        <!-- Slide 38: Grace Changes Desires -->
        <section class="slide" aria-hidden="true">
            <h2>Internal Revolution</h2>
            <div class="quote">
                "Grace teaches us to say 'no' to ungodliness"
            </div>
            <div class="reflection-box">
                <p class="reflection-prompt">Notice how your appetites change:</p>
                <ul class="bullet-list">
                    <li>Sin becomes less appealing</li>
                    <li>Holiness becomes attractive</li>
                    <li>You hunger for God's Word</li>
                    <li>Prayer becomes natural</li>
                    <li>Love for others grows</li>
                </ul>
            </div>
            <p style="color: var(--text-secondary); font-size: 1.5rem;">
                This isn't willpower - it's grace power!
            </p>
        </section>

        <!-- Slide 39: God Works In You -->
        <section class="slide" aria-hidden="true">
            <h2>Divine Partnership</h2>
            <div class="scripture">
                "For it is God who works in you both to will and to do for His good pleasure"
                <div class="scripture-reference">Philippians 2:13</div>
            </div>
            <div class="visual-metaphor">
                <div class="action-steps">
                    <div class="action-step">God changes your "want to" (will)</div>
                    <div class="action-step">God enables your "able to" (do)</div>
                    <div class="action-step">You cooperate with His work</div>
                    <div class="action-step">Transformation happens naturally</div>
                </div>
            </div>
        </section>

        <!-- Slide 40: New Creation Reality -->
        <section class="slide" aria-hidden="true">
            <h2>Your New Identity</h2>
            <div class="scripture">
                "Therefore, if anyone is in Christ, he is a new creation; old things have passed away; behold, all things have become new"
                <div class="scripture-reference">2 Corinthians 5:17</div>
            </div>
            <div class="comparison">
                <div class="comparison-side before-side">
                    <div class="comparison-title">Old Creation</div>
                    <p>Dead in sin<br>Slave to sin<br>Child of wrath<br>Darkness</p>
                </div>
                <div class="comparison-side after-side">
                    <div class="comparison-title">New Creation</div>
                    <p>Alive in Christ<br>Free from sin<br>Child of God<br>Light</p>
                </div>
            </div>
        </section>

        <!-- Slide 41: Section Break - Prayer Application -->
        <section class="slide section-break" aria-hidden="true">
            <h1>Part 7: Prayer Application</h1>
            <h2>Making It Personal</h2>
            <p class="subtitle">Prayers That Apply Gospel Truth</p>
        </section>

        <!-- Slide 42: Prayer for Understanding -->
        <section class="slide" aria-hidden="true">
            <h2>Prayer for Legal Standing</h2>
            <div class="scripture">
                "Father, we thank You that our peace with You is not based on emotions, but on the solid legal foundation of what Christ accomplished. Help us stand confidently in this truth."
                <div class="scripture-reference">Based on Romans 5:1</div>
            </div>
            <div class="reflection-box">
                <p class="reflection-prompt">Personalize this prayer:</p>
                <p>"Lord, when I feel ___________, remind me that my legal standing is ___________."</p>
            </div>
        </section>

        <!-- Slide 43: Prayer Against Condemnation -->
        <section class="slide" aria-hidden="true">
            <h2>Prayer for Freedom</h2>
            <div class="scripture">
                "Lord, we declare that there is no condemnation for those in Christ Jesus. When guilt tries to overwhelm us, remind us that You justify us, not condemn us."
                <div class="scripture-reference">Based on Romans 8:1</div>
            </div>
            <div class="action-steps">
                <div class="action-step">Identify areas where condemnation attacks</div>
                <div class="action-step">Speak truth over those areas</div>
                <div class="action-step">Stand firm in your justified position</div>
                <div class="action-step">Reject false guilt and shame</div>
            </div>
        </section>

        <!-- Slide 44: Prayer for Confidence -->
        <section class="slide" aria-hidden="true">
            <h2>Prayer for Bold Faith</h2>
            <div class="scripture">
                "When circumstances overwhelm us, help us boldly declare: 'If God is for us, who can be against us?' Give us unwavering confidence in Your love."
                <div class="scripture-reference">Based on Romans 8:31</div>
            </div>
            <div class="quote">
                "I will not fear because God is FOR me!"
            </div>
        </section>

        <!-- Slide 45: Prayer for Transformation -->
        <section class="slide" aria-hidden="true">
            <h2>Prayer for Grace to Work</h2>
            <div class="scripture">
                "Lord, let Your grace work powerfully in us, changing our desires and transforming us from glory to glory into the image of Christ."
                <div class="scripture-reference">Based on Romans 5:2</div>
            </div>
            <div class="takeaways">
                <div class="takeaway-item">
                    <div class="takeaway-icon">🔄</div>
                    <strong>Change my desires</strong>
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">💪</div>
                    <strong>Strengthen my will</strong>
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">🎯</div>
                    <strong>Direct my steps</strong>
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">✨</div>
                    <strong>Complete Your work</strong>
                </div>
            </div>
        </section>

        <!-- Slide 46: Section Break - Call to Action -->
        <section class="slide section-break" aria-hidden="true">
            <h1>Part 8: The Call to Action</h1>
            <h2>Share This Gospel</h2>
            <p class="subtitle">The World Is Desperate for This Message</p>
        </section>

        <!-- Slide 47: The World's Need -->
        <section class="slide" aria-hidden="true">
            <h2>A Desperate World</h2>
            <div class="visual-metaphor">
                <h3 style="color: var(--accent-color); margin-bottom: 30px;">Look Around You:</h3>
                <div class="card-grid">
                    <div class="info-card">
                        <div class="info-card-icon">😔</div>
                        <div class="info-card-title">Depression</div>
                        <div class="info-card-content">People without hope</div>
                    </div>
                    <div class="info-card">
                        <div class="info-card-icon">😰</div>
                        <div class="info-card-title">Anxiety</div>
                        <div class="info-card-content">Living in fear</div>
                    </div>
                    <div class="info-card">
                        <div class="info-card-icon">💔</div>
                        <div class="info-card-title">Broken</div>
                        <div class="info-card-content">Relationships failing</div>
                    </div>
                    <div class="info-card">
                        <div class="info-card-icon">⛓️</div>
                        <div class="info-card-title">Bondage</div>
                        <div class="info-card-content">Slaves to sin</div>
                    </div>
                    <div class="info-card">
                        <div class="info-card-icon">❓</div>
                        <div class="info-card-title">Lost</div>
                        <div class="info-card-content">No direction</div>
                    </div>
                    <div class="info-card">
                        <div class="info-card-icon">⚰️</div>
                        <div class="info-card-title">Dying</div>
                        <div class="info-card-content">Without Christ</div>
                    </div>
                </div>
            </div>
            <p style="font-size: 1.8rem; color: var(--text-secondary); margin-top: 30px;">
                They need to hear about the Peace Child!
            </p>
        </section>

        <!-- Slide 48: Simple Faith -->
        <section class="slide" aria-hidden="true">
            <h2>How to Receive This Grace</h2>
            <div class="quote">
                "Faith is simply an empty hand that receives what Christ has done"
            </div>
            <div class="action-steps">
                <div class="action-step">Acknowledge your need for peace with God</div>
                <div class="action-step">Believe Jesus is God's Peace Child for you</div>
                <div class="action-step">Receive His finished work by faith</div>
                <div class="action-step">Rest in your new legal standing</div>
                <div class="action-step">Share this good news with others</div>
            </div>
        </section>

        <!-- Slide 49: Evangelistic Passion -->
        <section class="slide" aria-hidden="true">
            <h2>Motivated from Within</h2>
            <div class="reflection-box">
                <p class="reflection-prompt">When this truth grips your heart:</p>
                <ul class="bullet-list">
                    <li>You can't keep quiet about it</li>
                    <li>Joy overflows into testimony</li>
                    <li>Gratitude becomes evangelism</li>
                    <li>Love compels you to share</li>
                    <li>Lives are transformed through you</li>
                </ul>
            </div>
            <div class="quote">
                "Don't come alone next week - bring someone who needs this!"
            </div>
        </section>

        <!-- Slide 50: Key Truths Summary -->
        <section class="slide" aria-hidden="true">
            <h2>Remember These Truths</h2>
            <div class="takeaways">
                <div class="takeaway-item">
                    <div class="takeaway-icon">✝️</div>
                    <strong>"Jesus is the Peace Child"</strong>
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">🕊️</div>
                    <strong>"The bombs have stopped falling"</strong>
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">🏠</div>
                    <strong>"God treats us as though we never left"</strong>
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">📜</div>
                    <strong>"This peace is mine legally"</strong>
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">✨</div>
                    <strong>"Grace will teach you to say no"</strong>
                </div>
                <div class="takeaway-item">
                    <div class="takeaway-icon">💪</div>
                    <strong>"God is working in you"</strong>
                </div>
            </div>
        </section>

        <!-- Slide 51: Foundation for Life -->
        <section class="slide" aria-hidden="true">
            <h2>Build Your Life on This</h2>
            <div class="scripture">
                "This peace with God is the bedrock of the Christian life. It's the most fundamental blessing of being in Christ upon which all other hopes and joys are built."
            </div>
            <div class="visual-metaphor">
                <h3 style="margin: 30px 0;">What Changes When This Is Your Foundation:</h3>
                <div class="journey-map">
                    <div class="journey-step">
                        <div class="journey-icon">🪞</div>
                        <div class="journey-title">Self</div>
                        <p>Identity secured</p>
                    </div>
                    <div class="journey-step">
                        <div class="journey-icon">👥</div>
                        <div class="journey-title">Others</div>
                        <p>Love flows freely</p>
                    </div>
                    <div class="journey-step">
                        <div class="journey-icon">⛈️</div>
                        <div class="journey-title">Trials</div>
                        <p>Peace remains</p>
                    </div>
                    <div class="journey-step">
                        <div class="journey-icon">💀</div>
                        <div class="journey-title">Death</div>
                        <p>No fear</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Slide 52: Personal Response -->
        <section class="slide cta" aria-hidden="true">
            <h1>Your Response Today</h1>
            <div class="reflection-box" style="background: rgba(255, 255, 255, 0.1); border-color: white;">
                <p class="reflection-prompt" style="color: white;">What will you do with this message?</p>
                <div class="action-steps" style="color: white;">
                    <div class="action-step" style="background: rgba(255, 255, 255, 0.2); border-left-color: white;">
                        Accept Jesus as your Peace Child today</div>
                    <div class="action-step" style="background: rgba(255, 255, 255, 0.2); border-left-color: white;">
                        Believe this gospel is completely true</div>
                    <div class="action-step" style="background: rgba(255, 255, 255, 0.2); border-left-color: white;">
                        Rest in what Christ has accomplished</div>
                    <div class="action-step" style="background: rgba(255, 255, 255, 0.2); border-left-color: white;">
                        Share this good news with someone this week</div>
                    <div class="action-step" style="background: rgba(255, 255, 255, 0.2); border-left-color: white;">
                        Live in the reality of God's peace daily</div>
                </div>
            </div>
        </section>

        <!-- Slide 53: Salvation Prayer -->
        <section class="slide" aria-hidden="true">
            <h2>Prayer of Salvation</h2>
            <div class="scripture">
                "Dear God, I acknowledge that I have been at war with You through my sin. I believe that Jesus is Your Peace Child, given to reconcile me to You. I receive His sacrifice on my behalf. Thank You that the war is over and I am now at peace with You. I accept Your love, Your forgiveness, and Your grace. Transform me by Your Holy Spirit. In Jesus' name, Amen."
            </div>
            <p style="margin-top: 30px; font-size: 1.6rem; color: var(--text-secondary);">
                If you prayed this prayer, welcome to God's family!
            </p>
        </section>

        <!-- Slide 54: Next Steps -->
        <section class="slide" aria-hidden="true">
            <h2>Your Next Steps</h2>
            <div class="action-steps">
                <div class="action-step">Tell someone about your decision today</div>
                <div class="action-step">Get connected with a Bible-believing church</div>
                <div class="action-step">Begin reading the Gospel of John</div>
                <div class="action-step">Talk to God daily in prayer</div>
                <div class="action-step">Find other believers to journey with</div>
                <div class="action-step">Get baptized as a public declaration</div>
                <div class="action-step">Share your testimony with others</div>
            </div>
        </section>

        <!-- Slide 55: Closing Blessing -->
        <section class="slide" aria-hidden="true">
            <h1>The Gospel of Grace</h1>
            <h2>Go in Peace</h2>
            <div class="quote">
                "Jesus is the Peace Child. The war has ended. The bombs have stopped falling. You are at peace with God forever."
            </div>
            <div class="scripture">
                "May the God of peace Himself sanctify you completely; and may your whole spirit, soul, and body be preserved blameless at the coming of our Lord Jesus Christ."
                <div class="scripture-reference">1 Thessalonians 5:23</div>
            </div>
            <p style="margin-top: 40px; font-size: 1.6rem; color: var(--accent-color);">
                Transform lives with this message. Start today!
            </p>
        </section>

    </main>

    <!-- Navigation Controls -->
    <div class="nav-controls" role="navigation" aria-label="Slide controls">
        <button class="nav-button" id="prevBtn" onclick="changeSlide(-1)" aria-label="Previous slide">Previous</button>
        <button class="nav-button" id="nextBtn" onclick="changeSlide(1)" aria-label="Next slide">Next</button>
    </div>

    <!-- Slide Counter -->
    <div class="slide-counter" id="slideCounter" aria-live="polite" aria-atomic="true">1 / 55</div>

    <script>
        // Enhanced JavaScript Controller
        const PresentationController = (function() {
            let currentSlide = 0;
            let slides = [];
            let totalSlides = 0;
            let jumpBuffer = '';
            let jumpTimeout = null;

            const elements = {};

            // Expanded slide titles with sections
            const slideTitles = [
                "The Gospel of Grace",
                "A Moment of Reflection",
                "This Week's Prayer Focus",
                "Our Foundation Scripture",
                "Part 1: The Peace Child Story",
                "The Missionary's Challenge",
                "Understanding the Sawi Worldview",
                "God's Wisdom Revealed",
                "The Peace Child Covenant",
                "The Divine Revelation",
                "Jesus: The Ultimate Peace Child",
                "What This Means For You",
                "Part 2: The War Has Ended",
                "A Powerful Metaphor",
                "Your New Reality in Christ",
                "How God Sees You Now",
                "Part 3: God Is FOR You",
                "What Then Shall We Say?",
                "How Can We Be Sure?",
                "Secure from All Accusations",
                "Eternally Secure",
                "The Unbreakable Bond",
                "Part 4: The Legal Foundation",
                "God Respects His Own Law",
                "What the Law Demanded",
                "Jesus Met Every Requirement",
                "You Have a Legal Deed",
                "The Heavenly Court Scene",
                "Part 5: The Prodigal Son",
                "The Journey Away and Back",
                "The Father Was Watching",
                "Dignity Laid Aside",
                "Complete Restoration",
                "This Is YOUR Story",
                "Part 6: Access to Grace",
                "Peace PLUS Access",
                "The Power of Grace",
                "Internal Revolution",
                "Divine Partnership",
                "Your New Identity",
                "Part 7: Prayer Application",
                "Prayer for Legal Standing",
                "Prayer for Freedom",
                "Prayer for Bold Faith",
                "Prayer for Grace to Work",
                "Part 8: The Call to Action",
                "A Desperate World",
                "How to Receive This Grace",
                "Motivated from Within",
                "Remember These Truths",
                "Build Your Life on This",
                "Your Response Today",
                "Prayer of Salvation",
                "Your Next Steps",
                "Go in Peace"
            ];

            function init() {
                cacheElements();
                slides = Array.from(document.querySelectorAll('.slide'));
                totalSlides = slides.length;
                generateSidebarNav();
                attachEventListeners();
                updateSlide();
                updateAriaStates();
            }

            function cacheElements() {
                elements.progressBar = document.getElementById('progressBar');
                elements.slideCounter = document.getElementById('slideCounter');
                elements.prevBtn = document.getElementById('prevBtn');
                elements.nextBtn = document.getElementById('nextBtn');
                elements.sidebar = document.getElementById('sidebar');
                elements.sidebarNav = document.getElementById('sidebarNav');
                elements.sidebarOverlay = document.querySelector('.sidebar-overlay');
                elements.presentation = document.getElementById('presentation');
                elements.sidebarToggle = document.querySelector('.sidebar-toggle');
                elements.helpModal = document.getElementById('helpModal');
            }

            function generateSidebarNav() {
                const fragment = document.createDocumentFragment();
                let currentSection = null;

                slides.forEach((slide, index) => {
                    const title = slideTitles[index] || `Slide ${index + 1}`;

                    // Check if this is a section break
                    if (title.startsWith('Part ')) {
                        currentSection = document.createElement('div');
                        currentSection.className = 'sidebar-section';
                        const sectionTitle = document.createElement('div');
                        sectionTitle.className = 'sidebar-section-title';
                        sectionTitle.textContent = title.split(':')[0];
                        currentSection.appendChild(sectionTitle);
                        fragment.appendChild(currentSection);
                    }

                    const navItem = document.createElement('div');
                    navItem.className = 'sidebar-item';
                    navItem.setAttribute('role', 'listitem');
                    navItem.setAttribute('tabindex', '0');

                    if (index === currentSlide) {
                        navItem.classList.add('active');
                        navItem.setAttribute('aria-current', 'true');
                    }

                    if (slide.classList.contains('section-break')) {
                        navItem.classList.add('section-break');
                    }

                    navItem.innerHTML = `
                        <div class="sidebar-item-number">${index + 1}</div>
                        <div class="sidebar-item-title">${title}</div>
                    `;

                    navItem.addEventListener('click', () => {
                        goToSlide(index);
                        closeSidebar();
                    });

                    navItem.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            goToSlide(index);
                            closeSidebar();
                        }
                    });

                    if (currentSection && !title.startsWith('Part ')) {
                        currentSection.appendChild(navItem);
                    } else {
                        fragment.appendChild(navItem);
                    }
                });

                elements.sidebarNav.innerHTML = '';
                elements.sidebarNav.appendChild(fragment);
            }

            function updateSidebarActive() {
                const navItems = document.querySelectorAll('.sidebar-item');
                navItems.forEach((item, index) => {
                    if (index === currentSlide) {
                        item.classList.add('active');
                        item.setAttribute('aria-current', 'true');
                        // Scroll into view if needed
                        item.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    } else {
                        item.classList.remove('active');
                        item.removeAttribute('aria-current');
                    }
                });
            }

            function updateAriaStates() {
                slides.forEach((slide, index) => {
                    slide.setAttribute('aria-hidden', index !== currentSlide);
                    slide.setAttribute('aria-label', `Slide ${index + 1} of ${totalSlides}: ${slideTitles[index] || ''}`);
                });

                elements.progressBar.setAttribute('aria-valuenow', Math.round(((currentSlide + 1) / totalSlides) * 100));
            }

            function goToSlide(slideIndex) {
                if (slideIndex >= 0 && slideIndex < totalSlides) {
                    currentSlide = slideIndex;
                    updateSlide();
                }
            }

            function updateSlide() {
                slides.forEach((slide, index) => {
                    slide.classList.toggle('active', index === currentSlide);
                });

                const progress = ((currentSlide + 1) / totalSlides) * 100;
                elements.progressBar.style.width = progress + '%';

                elements.slideCounter.textContent = `${currentSlide + 1} / ${totalSlides}`;

                elements.prevBtn.disabled = currentSlide === 0;
                elements.nextBtn.disabled = currentSlide === totalSlides - 1;

                updateSidebarActive();
                updateAriaStates();

                sessionStorage.setItem('currentSlide', currentSlide);
            }

            function changeSlide(direction) {
                const newSlide = currentSlide + direction;
                if (newSlide >= 0 && newSlide < totalSlides) {
                    goToSlide(newSlide);
                }
            }

            function handleKeydown(e) {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

                if (e.key >= '0' && e.key <= '9') {
                    jumpBuffer += e.key;
                    clearTimeout(jumpTimeout);
                    jumpTimeout = setTimeout(() => {
                        const slideNum = parseInt(jumpBuffer) - 1;
                        if (slideNum >= 0 && slideNum < totalSlides) {
                            goToSlide(slideNum);
                        }
                        jumpBuffer = '';
                    }, 500);
                    return;
                }

                switch(e.key) {
                    case 'ArrowLeft':
                    case 'ArrowUp':
                        e.preventDefault();
                        changeSlide(-1);
                        break;
                    case 'ArrowRight':
                    case 'ArrowDown':
                    case ' ':
                        e.preventDefault();
                        changeSlide(1);
                        break;
                    case 'Home':
                        e.preventDefault();
                        goToSlide(0);
                        break;
                    case 'End':
                        e.preventDefault();
                        goToSlide(totalSlides - 1);
                        break;
                    case 'Escape':
                        closeSidebar();
                        closeHelp();
                        break;
                    case 'm':
                    case 'M':
                        e.preventDefault();
                        toggleSidebar();
                        break;
                    case 'f':
                    case 'F':
                        e.preventDefault();
                        toggleFullscreen();
                        break;
                    case '?':
                    case 'h':
                    case 'H':
                        e.preventDefault();
                        toggleHelp();
                        break;
                    case 'g':
                    case 'G':
                        e.preventDefault();
                        jumpBuffer = '';
                        break;
                }
            }

            function attachEventListeners() {
                document.addEventListener('keydown', handleKeydown);

                let touchStartX = 0;
                let touchStartY = 0;

                document.addEventListener('touchstart', (e) => {
                    touchStartX = e.touches[0].clientX;
                    touchStartY = e.touches[0].clientY;
                }, { passive: true });

                document.addEventListener('touchend', (e) => {
                    if (elements.sidebar.classList.contains('open')) return;

                    const touchEndX = e.changedTouches[0].clientX;
                    const touchEndY = e.changedTouches[0].clientY;
                    const deltaX = touchEndX - touchStartX;
                    const deltaY = touchEndY - touchStartY;

                    if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
                        if (deltaX > 0) {
                            changeSlide(-1);
                        } else {
                            changeSlide(1);
                        }
                    }
                }, { passive: true });

                window.addEventListener('resize', debounce(() => {
                    if (window.innerWidth <= 768) {
                        elements.presentation.classList.remove('sidebar-open');
                    }
                }, 250));

                const savedSlide = sessionStorage.getItem('currentSlide');
                if (savedSlide !== null) {
                    goToSlide(parseInt(savedSlide));
                }
            }

            function debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            return {
                init,
                changeSlide,
                goToSlide
            };
        })();

        // Global functions
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            const toggle = document.querySelector('.sidebar-toggle');

            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');

            const isOpen = sidebar.classList.contains('open');
            toggle.setAttribute('aria-expanded', isOpen);

            if (window.innerWidth > 768) {
                document.getElementById('presentation').classList.toggle('sidebar-open');
            }
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.sidebar-overlay');
            const toggle = document.querySelector('.sidebar-toggle');

            sidebar.classList.remove('open');
            overlay.classList.remove('active');
            document.getElementById('presentation').classList.remove('sidebar-open');
            toggle.setAttribute('aria-expanded', 'false');
        }

        function toggleHelp() {
            const helpModal = document.getElementById('helpModal');
            const isActive = helpModal.classList.contains('active');

            helpModal.classList.toggle('active');
            helpModal.setAttribute('aria-hidden', !isActive);
        }

        function closeHelp() {
            const helpModal = document.getElementById('helpModal');
            helpModal.classList.remove('active');
            helpModal.setAttribute('aria-hidden', 'true');
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                document.exitFullscreen();
            }
        }

        function changeSlide(direction) {
            PresentationController.changeSlide(direction);
        }

        // Initialize
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', PresentationController.init);
        } else {
            PresentationController.init();
        }
    </script>
</body>
</html>